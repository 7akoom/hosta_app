# ุฅุตูุงุญ ูุดููุฉ ุฒุฑ ุงูุฑุฌูุน - Back Button Fix

## ุงููุดููุฉ
ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ ุงูุฑุฌูุน ููุฎุฑูุฌ ูู ุงูุชุทุจููุ ูุงูุช ุชุธูุฑ ุฑุณุงูุฉ "ุงุถุบุท ูุฑุฉ ุฃุฎุฑู ููุฎุฑูุฌ" ูููู ุงูุชุทุจูู ูุง ูุฎุฑุฌ ุญุชู ูุน ุงูุถุบุท ุงููุชูุฑุฑ.

## ุณุจุจ ุงููุดููุฉ
ุงููุดููุฉ ูุงูุช ูู ููุทู `PopScope` ูู `main_screen.dart`:
- `PopScope` ูุงู ูููุน ุงูุฎุฑูุฌ (`canPop: false`)
- ููู ูู ููู ููุงู ุขููุฉ ููุฎุฑูุฌ ุงููุนูู ูู ุงูุชุทุจูู
- `_handleBackPress` ูุงู ูุฑุฌุน `true` ููู ูุง ูุชู ุงุณุชุฎุฏุงู ุงููููุฉ

## ุงูุญู ุงููุทุจู

### 1. ุชุญุณูู ููุทู `_handleBackPress`

**ูุจู ุงูุฅุตูุงุญ:**
```dart
onPopInvoked: (didPop) {
  if (!didPop) {
    _handleBackPress(context); // ูุง ูุชู ุงุณุชุฎุฏุงู ุงููููุฉ ุงููุฑุฌุนุฉ
  }
},
```

**ุจุนุฏ ุงูุฅุตูุงุญ:**
```dart
onPopInvoked: (didPop) {
  if (!didPop) {
    final shouldPop = _handleBackPress(context);
    if (shouldPop) {
      // ุฅุฐุง ูุงู ูุฌุจ ุงูุฎุฑูุฌุ ูุฎุฑุฌ ูู ุงูุชุทุจูู
      SystemNavigator.pop();
    }
  }
},
```

### 2. ุฅุถุงูุฉ import ุงููุทููุจ

```dart
import 'package:flutter/services.dart';
```

### 3. ุชุญุณูู ุงูุชุนูููุงุช

```dart
// ุฅุฐุง ุชู ุงูุถุบุท ูุฑุชูู ุฎูุงู ุซุงููุชููุ ูุฎุฑุฌ ูู ุงูุชุทุจูู
return true;
```

## ููู ูุนูู ุงูุขู

### ุงูุณููุงุฑูู ุงูุฃูู: ูู ุดุงุดุฉ ุฃุฎุฑู ุบูุฑ ุงูุฑุฆูุณูุฉ
1. ุงููุณุชุฎุฏู ูุถุบุท ุฒุฑ ุงูุฑุฌูุน
2. ุงูุชุทุจูู ูุนูุฏ ุฅูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ
3. ูุง ูุฎุฑุฌ ูู ุงูุชุทุจูู

### ุงูุณููุงุฑูู ุงูุซุงูู: ูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ - ุงูุถุบุท ุงูุฃูู
1. ุงููุณุชุฎุฏู ูุถุบุท ุฒุฑ ุงูุฑุฌูุน
2. ุชุธูุฑ ุฑุณุงูุฉ "ุงุถุบุท ูุฑุฉ ุฃุฎุฑู ููุฎุฑูุฌ"
3. ูุง ูุฎุฑุฌ ูู ุงูุชุทุจูู

### ุงูุณููุงุฑูู ุงูุซุงูุซ: ูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ - ุงูุถุบุท ุงูุซุงูู
1. ุงููุณุชุฎุฏู ูุถุบุท ุฒุฑ ุงูุฑุฌูุน ูุฑุฉ ุฃุฎุฑู ุฎูุงู ุซุงููุชูู
2. `_handleBackPress` ูุฑุฌุน `true`
3. `SystemNavigator.pop()` ูุชู ุงุณุชุฏุนุงุคู
4. ุงูุชุทุจูู ูุฎุฑุฌ ุจูุฌุงุญ

## ุงูููุฏ ุงููุงูู ุงููุญุณู

```dart
bool _handleBackPress(BuildContext context) {
  if (_selectedIndex != 0) {
    // ุฅุฐุง ูู ููู ูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉุ ูุนูุฏ ุฅูููุง
    setState(() {
      _selectedIndex = 0;
    });
    return false;
  }

  // ูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉุ ูุชุญูู ูู ุงูููุฑ ุงููุฒุฏูุฌ
  final now = DateTime.now();
  if (_lastBackPressTime == null ||
      now.difference(_lastBackPressTime!) > const Duration(seconds: 2)) {
    _lastBackPressTime = now;

    ScaffoldMessenger.of(context).showSnackBar(
      SnackBar(
        content: Text(
          AppLocalizations.of(context)?.press_back_again ??
              'Press back again to exit',
        ),
        duration: const Duration(seconds: 2),
      ),
    );

    return false;
  }
  
  // ุฅุฐุง ุชู ุงูุถุบุท ูุฑุชูู ุฎูุงู ุซุงููุชููุ ูุฎุฑุฌ ูู ุงูุชุทุจูู
  return true;
}

@override
Widget build(BuildContext context) {
  return PopScope(
    canPop: false,
    onPopInvoked: (didPop) {
      if (!didPop) {
        final shouldPop = _handleBackPress(context);
        if (shouldPop) {
          // ุฅุฐุง ูุงู ูุฌุจ ุงูุฎุฑูุฌุ ูุฎุฑุฌ ูู ุงูุชุทุจูู
          SystemNavigator.pop();
        }
      }
    },
    child: Scaffold(
      body: _screens[_selectedIndex],
      bottomNavigationBar: CustomBottomNavigation(
        currentIndex: _selectedIndex,
        onTap: _onBottomNavTap,
      ),
    ),
  );
}
```

## ุงููุชุงุฆุฌ

### โ ุชู ุฅุตูุงุญ ุงููุดุงูู:
1. **ุงูุฎุฑูุฌ ูู ุงูุชุทุจูู:** ูุนูู ุงูุขู ุจุดูู ุตุญูุญ
2. **ุงูุถุบุท ุงููุฒุฏูุฌ:** ูุนูู ุฎูุงู ุซุงููุชูู
3. **ุงูุฑุณุงุฆู:** ุชุธูุฑ ุจุดูู ุตุญูุญ
4. **ุงูุชููู:** ูุนูู ุจูู ุงูุดุงุดุงุช

### ๐ฏ ุงููููุฒุงุช:
- ุชุฌุฑุจุฉ ูุณุชุฎุฏู ูุญุณูุฉ
- ููุทู ูุงุถุญ ูููููู
- ุฑุณุงุฆู ูุงุถุญุฉ ูููุณุชุฎุฏู
- ุณููู ูุชููุน ููุชูุงุณู

## ุงุฎุชุจุงุฑ ุงููุธุงุฆู

ุชุฃูุฏ ูู:
- [ ] ุงูุถุบุท ุนูู ุฒุฑ ุงูุฑุฌูุน ูู ุดุงุดุฉ ุฃุฎุฑู ูุนูุฏ ููุดุงุดุฉ ุงูุฑุฆูุณูุฉ
- [ ] ุงูุถุบุท ุงูุฃูู ูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ ูุธูุฑ ุฑุณุงูุฉ
- [ ] ุงูุถุบุท ุงูุซุงูู ุฎูุงู ุซุงููุชูู ูุฎุฑุฌ ูู ุงูุชุทุจูู
- [ ] ุงูุงูุชุธุงุฑ ุฃูุซุฑ ูู ุซุงููุชูู ูุนูุฏ ุฏูุฑุฉ ุงูุถุบุท ุงูุฃูู
- [ ] ุงูุฑุณุงุฆู ุชุธูุฑ ุจุงููุบุฉ ุงูุตุญูุญุฉ



